<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-smart-wallet-program" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Smart Wallet Program | Goki Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stayrar3.github.io/doc_goki/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://stayrar3.github.io/doc_goki/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://stayrar3.github.io/doc_goki/docs/smart-wallet-program"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Smart Wallet Program | Goki Documentation"><meta data-rh="true" name="description" content="Welcome back, Goki explorers! In our previous chapters, we&#x27;ve explored the Goki SDK as your toolkit and the SmartWalletWrapper as your remote control for Goki Smart Wallets. We also learned about the crucial rules of Owners &amp; Threshold and the added safety of Timelock."><meta data-rh="true" property="og:description" content="Welcome back, Goki explorers! In our previous chapters, we&#x27;ve explored the Goki SDK as your toolkit and the SmartWalletWrapper as your remote control for Goki Smart Wallets. We also learned about the crucial rules of Owners &amp; Threshold and the added safety of Timelock."><link data-rh="true" rel="icon" href="/doc_goki/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://stayrar3.github.io/doc_goki/docs/smart-wallet-program"><link data-rh="true" rel="alternate" href="https://stayrar3.github.io/doc_goki/docs/smart-wallet-program" hreflang="en"><link data-rh="true" rel="alternate" href="https://stayrar3.github.io/doc_goki/docs/smart-wallet-program" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Smart Wallet Program","item":"https://stayrar3.github.io/doc_goki/docs/smart-wallet-program"}]}</script><link rel="alternate" type="application/rss+xml" href="/doc_goki/blog/rss.xml" title="Goki Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc_goki/blog/atom.xml" title="Goki Documentation Atom Feed"><link rel="stylesheet" href="/doc_goki/assets/css/styles.a05840f5.css">
<script src="/doc_goki/assets/js/runtime~main.85ac3758.js" defer="defer"></script>
<script src="/doc_goki/assets/js/main.ddaf4c6c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/doc_goki/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc_goki/"><div class="navbar__logo"><img src="/doc_goki/img/logo.svg" alt="Goki Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc_goki/img/logo.svg" alt="Goki Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Goki Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc_goki/docs/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/stayrar3/doc_goki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/intro">Introduction to Goki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/timelock">Timelock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/goki-sdk">Goki SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/transaction-state-account">Transaction State Account</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/instruction-execution-cpi">Instruction Execution (CPI)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/program-derived-addresses-pdas">Program Derived Addresses (PDAs)</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/doc_goki/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Smart Wallet Program</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Smart Wallet Program</h1></header>
<p>Welcome back, Goki explorers! In our previous chapters, we&#x27;ve explored the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> as your toolkit and the <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a> as your remote control for Goki Smart Wallets. We also learned about the crucial rules of <a href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a> and the added safety of <a href="/doc_goki/docs/timelock">Timelock</a>.</p>
<p>But all these amazing features, rules, and controls don&#x27;t just happen by magic. They are enforced by a powerful piece of code that lives permanently on the Solana blockchain: the <strong>Smart Wallet Program</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-brain-of-the-goki-system">The Brain of the Goki System<a href="#the-brain-of-the-goki-system" class="hash-link" aria-label="Direct link to The Brain of the Goki System" title="Direct link to The Brain of the Goki System">​</a></h2>
<p>Imagine your Smart Wallet is a high-tech vault for your digital assets. The <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a> is the keypad and screen on the vault door, and the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> is the engineering manual for the keypad. But the <strong>Smart Wallet Program</strong> is the actual <em>computer brain</em> inside the vault that processes every command, checks all the rules, and ensures everything is secure.</p>
<p>This program is the <strong>core smart contract</strong> residing directly on the Solana blockchain. It defines the complete logic and rules for how a Goki Smart Wallet operates. When you use the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> or <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a> to propose, approve, or execute a transaction, you&#x27;re ultimately sending instructions to this Smart Wallet Program.</p>
<p><strong>What problem does it solve?</strong> It provides a decentralized, transparent, and unchangeable set of rules for managing shared digital assets. Because it lives on the blockchain, everyone can see its code, and once deployed, its rules cannot be changed without another multi-signature process, providing maximum security and trust.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-concepts-what-is-a-program-on-solana">Key Concepts: What is a Program on Solana?<a href="#key-concepts-what-is-a-program-on-solana" class="hash-link" aria-label="Direct link to Key Concepts: What is a Program on Solana?" title="Direct link to Key Concepts: What is a Program on Solana?">​</a></h2>
<p>Before diving deeper, let&#x27;s quickly clarify what a &quot;program&quot; means in the context of Solana:</p>
<ul>
<li><strong>Like an App on a Smartphone</strong>: Think of a program on Solana as an application or software that runs directly on the blockchain. Just as an app has specific functions (like &quot;send message&quot; or &quot;take photo&quot;), a Solana program has specific instructions it can execute (like &quot;create a Smart Wallet&quot; or &quot;execute a transaction&quot;).</li>
<li><strong>Written in Rust</strong>: Most Solana programs, including Goki&#x27;s Smart Wallet Program, are written in a programming language called Rust.</li>
<li><strong>Immutable and Public</strong>: Once a program is deployed to the Solana blockchain, its code is generally unchangeable and publicly visible. This transparency is a key security feature, as anyone can verify its logic.</li>
<li><strong>Manages Accounts</strong>: Programs interact with &quot;accounts&quot; on the blockchain. Accounts are like files or storage locations where data is kept. The Smart Wallet Program manages two main types of accounts:<!-- -->
<ul>
<li>The <code>SmartWallet</code> account: Stores the wallet&#x27;s main configuration (like <a href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a> and <a href="/doc_goki/docs/timelock">Timelock</a> settings).</li>
<li>The <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>: Stores the details of a specific proposed transaction, including its approvals.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-programs-role-in-goki">The Program&#x27;s Role in Goki<a href="#the-programs-role-in-goki" class="hash-link" aria-label="Direct link to The Program&#x27;s Role in Goki" title="Direct link to The Program&#x27;s Role in Goki">​</a></h3>
<p>The Smart Wallet Program is responsible for:</p>
<table><thead><tr><th style="text-align:left">Feature</th><th style="text-align:left">Program&#x27;s Role</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Wallet Creation</strong></td><td style="text-align:left">It creates the <code>SmartWallet</code> account, storing the initial <a href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a> list, and the <a href="/doc_goki/docs/timelock">Timelock</a> <code>minimum_delay</code>.</td></tr><tr><td style="text-align:left"><strong>Transaction Proposal</strong></td><td style="text-align:left">It creates a <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> for each proposed action, recording the proposed instructions and the <code>eta</code> (<a href="/doc_goki/docs/timelock">Timelock</a>).</td></tr><tr><td style="text-align:left"><strong>Approval Enforcement</strong></td><td style="text-align:left">When an <code>owner</code> approves, it checks if the owner is valid and updates the <code>signers</code> list within the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>.</td></tr><tr><td style="text-align:left"><strong>Threshold Check</strong></td><td style="text-align:left">Before execution, it verifies that the <code>num_signers</code> on a transaction meets or exceeds the <code>threshold</code> set in the <code>SmartWallet</code> account.</td></tr><tr><td style="text-align:left"><strong>Timelock Enforcement</strong></td><td style="text-align:left">Before execution, it checks if the current time has passed the <code>eta</code> set for the transaction. If not, it prevents execution.</td></tr><tr><td style="text-align:left"><strong>Instruction Execution</strong></td><td style="text-align:left">Once all conditions (threshold, timelock) are met, it directly executes the instructions stored within the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> on behalf of the Smart Wallet.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-the-smart-wallet-program-works-with-your-commands">How the Smart Wallet Program Works with Your Commands<a href="#how-the-smart-wallet-program-works-with-your-commands" class="hash-link" aria-label="Direct link to How the Smart Wallet Program Works with Your Commands" title="Direct link to How the Smart Wallet Program Works with Your Commands">​</a></h2>
<p>As a developer using Goki, you don&#x27;t directly write Rust code to interact with the Smart Wallet Program. Instead, you use the convenient functions provided by the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> and the <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a>. These tools then construct the proper messages (called &quot;instructions&quot;) and send them to the Smart Wallet Program on the Solana blockchain.</p>
<p>Let&#x27;s revisit our example of creating a Smart Wallet and executing a transaction, but this time, focusing on the Smart Wallet Program&#x27;s perspective:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-creating-a-smart-wallet">1. Creating a Smart Wallet<a href="#1-creating-a-smart-wallet" class="hash-link" aria-label="Direct link to 1. Creating a Smart Wallet" title="Direct link to 1. Creating a Smart Wallet">​</a></h3>
<p>When you call <code>sdk.newSmartWallet</code>, the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> sends an instruction to the Smart Wallet Program.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// From Chapter 4: Goki SDK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newSmartWallet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  numOwners</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> owners</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  owners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  threshold</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  delay</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> delaySeconds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The program will store this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">confirm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;New Smart Wallet created by SDK:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toBase58</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><em>Program&#x27;s Action</em>: The Smart Wallet Program receives this instruction. It then creates a new <code>SmartWallet</code> account on the blockchain, storing the <code>owners</code> list, the <code>threshold</code>, and the <code>delay</code> (minimum timelock) inside this account. This defines the fundamental security rules for your new Smart Wallet.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-proposing-a-transaction">2. Proposing a Transaction<a href="#2-proposing-a-transaction" class="hash-link" aria-label="Direct link to 2. Proposing a Transaction" title="Direct link to 2. Proposing a Transaction">​</a></h3>
<p>When you call <code>smartWalletWrapper.newTransaction</code>, the <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a> sends another instruction to the Smart Wallet Program.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// From Chapter 1: SmartWalletWrapper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> transactionKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> proposeTx </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proposer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ownerA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instructions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">transferInstruction</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eta</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The program will store this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proposeTx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">signers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ownerA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> proposeTx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">confirm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Transaction proposed:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> transactionKey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toBase58</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><em>Program&#x27;s Action</em>: The Smart Wallet Program receives the proposal. It creates a new <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> to hold the details of this pending transaction. It records the proposed <code>instructions</code>, the <code>proposer</code>, and the <code>eta</code> (<a href="/doc_goki/docs/timelock">Timelock</a>) for this specific transaction. It also marks <code>ownerA</code> as having approved it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-approving-a-transaction">3. Approving a Transaction<a href="#3-approving-a-transaction" class="hash-link" aria-label="Direct link to 3. Approving a Transaction" title="Direct link to 3. Approving a Transaction">​</a></h3>
<p>When <code>smartWalletWrapper.approveTransaction</code> is called by another owner:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// From Chapter 1: SmartWalletWrapper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> smartWalletWrapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">approveTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">transactionKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ownerB</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addSigners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ownerB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">confirm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Transaction approved by Owner B.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><em>Program&#x27;s Action</em>: The Smart Wallet Program checks if <code>ownerB</code> is indeed one of the authorized <a href="/doc_goki/docs/owners-threshold">Owners</a> of this Smart Wallet. If yes, it updates the <code>signers</code> list within the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> to reflect <code>ownerB</code>&#x27;s approval. It now checks if the number of <code>signers</code> meets the <code>threshold</code> for the Smart Wallet.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-executing-a-transaction">4. Executing a Transaction<a href="#4-executing-a-transaction" class="hash-link" aria-label="Direct link to 4. Executing a Transaction" title="Direct link to 4. Executing a Transaction">​</a></h3>
<p>When <code>smartWalletWrapper.executeTransaction</code> is called:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// From Chapter 1: SmartWalletWrapper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> smartWalletWrapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">executeTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    owner</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ownerC</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addSigners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ownerC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">confirm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Transaction executed successfully!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><em>Program&#x27;s Action</em>: This is where the Smart Wallet Program performs its most critical checks:</p>
<ol>
<li><strong>Threshold Check</strong>: It first checks the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> to see if <code>num_signers</code> (total approvals) is greater than or equal to the <code>threshold</code> stored in the <code>SmartWallet</code> account. If not, it stops.</li>
<li><strong>Timelock Check</strong>: It checks if the current time on the blockchain has passed the <code>eta</code> stored in the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>. If the <code>eta</code> is in the future, it stops.</li>
<li><strong>Execution</strong>: If both checks pass, the Smart Wallet Program then takes the <code>instructions</code> from the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> and executes them directly on the Solana blockchain. This is when the SOL is actually sent, or other actions occur. It then marks the transaction as &quot;executed&quot; to prevent it from being run again.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="under-the-hood-the-program-in-action">Under the Hood: The Program in Action<a href="#under-the-hood-the-program-in-action" class="hash-link" aria-label="Direct link to Under the Hood: The Program in Action" title="Direct link to Under the Hood: The Program in Action">​</a></h2>
<p>The Smart Wallet Program (<code>programs/smart-wallet/src/lib.rs</code>) is the central piece of logic that makes Goki work. All the high-level commands from the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> translate into specific <em>instructions</em> that the program processes.</p>
<p>Here&#x27;s a simplified view of how your commands flow to the Smart Wallet Program:</p>
<!-- -->
<p><em>Explanation</em>: Each action you take through the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> eventually gets turned into a specific instruction for the <code>SmartWalletProgram</code>. The program then reads or writes data to the relevant accounts (<code>SmartWalletAccount</code> or <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>) on the blockchain, enforcing all the rules we&#x27;ve discussed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The <strong>Smart Wallet Program</strong> is the secure, rule-enforcing engine that powers every Goki Smart Wallet. It&#x27;s the central smart contract on the Solana blockchain that guarantees the multi-signature and timelock rules are always followed. While you interact with it through the user-friendly <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> and <a href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a>, understanding its role as the on-chain &quot;brain&quot; is key to appreciating the robust security Goki offers.</p>
<p>In the next chapter, we&#x27;ll delve deeper into the <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>, the specific place on the blockchain where the Smart Wallet Program stores all the information about your proposed and ongoing multi-signature transactions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/stayrar3/doc_goki/tree/main/docs/smart-wallet-program.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc_goki/docs/goki-sdk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Goki SDK</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc_goki/docs/transaction-state-account"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Transaction State Account</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-brain-of-the-goki-system" class="table-of-contents__link toc-highlight">The Brain of the Goki System</a></li><li><a href="#key-concepts-what-is-a-program-on-solana" class="table-of-contents__link toc-highlight">Key Concepts: What is a Program on Solana?</a><ul><li><a href="#the-programs-role-in-goki" class="table-of-contents__link toc-highlight">The Program&#39;s Role in Goki</a></li></ul></li><li><a href="#how-the-smart-wallet-program-works-with-your-commands" class="table-of-contents__link toc-highlight">How the Smart Wallet Program Works with Your Commands</a><ul><li><a href="#1-creating-a-smart-wallet" class="table-of-contents__link toc-highlight">1. Creating a Smart Wallet</a></li><li><a href="#2-proposing-a-transaction" class="table-of-contents__link toc-highlight">2. Proposing a Transaction</a></li><li><a href="#3-approving-a-transaction" class="table-of-contents__link toc-highlight">3. Approving a Transaction</a></li><li><a href="#4-executing-a-transaction" class="table-of-contents__link toc-highlight">4. Executing a Transaction</a></li></ul></li><li><a href="#under-the-hood-the-program-in-action" class="table-of-contents__link toc-highlight">Under the Hood: The Program in Action</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc_goki/docs/intro">Documentation</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/GokiProtocol/goki" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Goki Documentation. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>