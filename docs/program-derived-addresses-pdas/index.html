<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-program-derived-addresses-pdas" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Program Derived Addresses (PDAs) | Goki Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stayrar3.github.io/doc_goki/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://stayrar3.github.io/doc_goki/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://stayrar3.github.io/doc_goki/docs/program-derived-addresses-pdas"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Program Derived Addresses (PDAs) | Goki Documentation"><meta data-rh="true" name="description" content="Welcome back, Goki explorers! In our last chapter, Instruction Execution (CPI), we discovered how your Goki Smart Wallet (through its program) can delegate tasks to other Solana programs by &quot;signing&quot; on behalf of itself. But how exactly does a program, which doesn&#x27;t have a secret key like a human wallet, manage to &quot;sign&quot; anything or &quot;own&quot; accounts?"><meta data-rh="true" property="og:description" content="Welcome back, Goki explorers! In our last chapter, Instruction Execution (CPI), we discovered how your Goki Smart Wallet (through its program) can delegate tasks to other Solana programs by &quot;signing&quot; on behalf of itself. But how exactly does a program, which doesn&#x27;t have a secret key like a human wallet, manage to &quot;sign&quot; anything or &quot;own&quot; accounts?"><link data-rh="true" rel="icon" href="/doc_goki/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://stayrar3.github.io/doc_goki/docs/program-derived-addresses-pdas"><link data-rh="true" rel="alternate" href="https://stayrar3.github.io/doc_goki/docs/program-derived-addresses-pdas" hreflang="en"><link data-rh="true" rel="alternate" href="https://stayrar3.github.io/doc_goki/docs/program-derived-addresses-pdas" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Program Derived Addresses (PDAs)","item":"https://stayrar3.github.io/doc_goki/docs/program-derived-addresses-pdas"}]}</script><link rel="alternate" type="application/rss+xml" href="/doc_goki/blog/rss.xml" title="Goki Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc_goki/blog/atom.xml" title="Goki Documentation Atom Feed"><link rel="stylesheet" href="/doc_goki/assets/css/styles.ba795a2b.css">
<script src="/doc_goki/assets/js/runtime~main.92c6d7db.js" defer="defer"></script>
<script src="/doc_goki/assets/js/main.7d543981.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/doc_goki/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc_goki/"><div class="navbar__logo"><img src="/doc_goki/img/logo.svg" alt="Goki Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc_goki/img/logo.svg" alt="Goki Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Goki Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc_goki/docs/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/stayrar3/doc_goki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/intro">Introduction to Goki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/smart-wallet-wrapper">SmartWalletWrapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/timelock">Timelock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/goki-sdk">Goki SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/transaction-state-account">Transaction State Account</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc_goki/docs/instruction-execution-cpi">Instruction Execution (CPI)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc_goki/docs/program-derived-addresses-pdas">Program Derived Addresses (PDAs)</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/doc_goki/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Program Derived Addresses (PDAs)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Program Derived Addresses (PDAs)</h1></header>
<p>Welcome back, Goki explorers! In our last chapter, <a href="/doc_goki/docs/instruction-execution-cpi">Instruction Execution (CPI)</a>, we discovered how your Goki Smart Wallet (through its program) can delegate tasks to other Solana programs by &quot;signing&quot; on behalf of itself. But how exactly does a program, which doesn&#x27;t have a secret key like a human wallet, manage to &quot;sign&quot; anything or &quot;own&quot; accounts?</p>
<p>This is where <strong>Program Derived Addresses (PDAs)</strong> come into play. PDAs are a fundamental and magical concept on Solana that allows programs to truly own and control accounts, making powerful applications like Goki possible.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-company-vault-analogy">The Company Vault Analogy<a href="#the-company-vault-analogy" class="hash-link" aria-label="Direct link to The Company Vault Analogy" title="Direct link to The Company Vault Analogy">​</a></h2>
<p>Imagine a large corporation that needs its own bank accounts for various departments: one for payroll, one for operations, one for marketing. They don&#x27;t want a single person&#x27;s private key to control these main company accounts. Instead, they want the <em>company itself</em> (the corporation&#x27;s internal rules and systems) to be the sole authority.</p>
<p>On Solana, a &quot;program&quot; is like this corporation. It&#x27;s a piece of software living on the blockchain. A <strong>Program Derived Address (PDA)</strong> is like a &quot;company bank account&quot; that <strong>only the program itself</strong> can control. It&#x27;s a special kind of Public Key that doesn&#x27;t have a private key. This means no one can ever &quot;steal&quot; the secret key because it doesn&#x27;t exist! Only the specific program that <em>derived</em> that address can sign for it.</p>
<p><strong>What problem does it solve?</strong> PDAs allow Solana programs to securely manage and own digital assets and data without needing a human to hold a private key for those specific accounts. This is crucial for building complex applications like Goki, where the Smart Wallet itself needs to hold funds and execute transactions based on its multi-signature rules, rather than relying on an external, individual wallet.</p>
<p>In Goki, PDAs are used for several key purposes:</p>
<table><thead><tr><th style="text-align:left">PDA Use Case</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><strong>The <code>SmartWallet</code> Account</strong></td><td style="text-align:left">The main account that holds your Smart Wallet&#x27;s configuration (<a href="/doc_goki/docs/owners-threshold">Owners &amp; Threshold</a>, <a href="/doc_goki/docs/timelock">Timelock</a>). It&#x27;s a PDA, enabling the Goki program to control its own settings.</td></tr><tr><td style="text-align:left"><strong><code>Transaction</code> Accounts</strong></td><td style="text-align:left">Each proposed transaction is stored in its own unique <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a>, which is also a PDA. This allows the Goki program to manage and update its state securely.</td></tr><tr><td style="text-align:left"><strong>&quot;Derived Wallets&quot;</strong></td><td style="text-align:left">Special sub-accounts that act as extensions of the main Smart Wallet. These are PDAs and can hold specific assets, allowing for advanced fund management strategies.</td></tr><tr><td style="text-align:left"><strong>&quot;Owner Invokers&quot;</strong></td><td style="text-align:left">Unique PDAs tied to specific owners or functions, allowing for very fine-grained control and delegation within the Smart Wallet&#x27;s ecosystem.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-concepts-the-magic-of-pdas">Key Concepts: The Magic of PDAs<a href="#key-concepts-the-magic-of-pdas" class="hash-link" aria-label="Direct link to Key Concepts: The Magic of PDAs" title="Direct link to Key Concepts: The Magic of PDAs">​</a></h2>
<p>Let&#x27;s break down how these special addresses work.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-public-keys-vs-pdas-the-no-private-key-difference">1. Public Keys vs. PDAs: The &quot;No Private Key&quot; Difference<a href="#1-public-keys-vs-pdas-the-no-private-key-difference" class="hash-link" aria-label="Direct link to 1. Public Keys vs. PDAs: The &quot;No Private Key&quot; Difference" title="Direct link to 1. Public Keys vs. PDAs: The &quot;No Private Key&quot; Difference">​</a></h3>
<ul>
<li><strong>Regular Public Key</strong>: You generate a <code>Keypair</code>, which gives you a <code>PublicKey</code> and a matching <code>PrivateKey</code>. Anyone with the <code>PrivateKey</code> can sign for that <code>PublicKey</code>.</li>
<li><strong>Program Derived Address (PDA)</strong>: This is <em>also</em> a <code>PublicKey</code>. However, it <strong>does not have a matching <code>PrivateKey</code></strong>. It cannot be controlled by a human wallet. Instead, it is cryptographically linked to a specific Solana program.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-deterministic-generation-seeds-and-bumps">2. Deterministic Generation: Seeds and Bumps<a href="#2-deterministic-generation-seeds-and-bumps" class="hash-link" aria-label="Direct link to 2. Deterministic Generation: Seeds and Bumps" title="Direct link to 2. Deterministic Generation: Seeds and Bumps">​</a></h3>
<p>How do programs &quot;create&quot; these addresses without a private key? They use a process called <strong>deterministic generation</strong>. This means the address is always the same if you provide the same inputs.</p>
<ul>
<li><strong>Program ID</strong>: Every PDA is linked to a specific <strong>Program ID</strong> (the unique address of the program on Solana, like <code>GokivDYuQXPZCWRkwMhdH2h91KpDQXBEmpgBgs55bnpH</code> for the Smart Wallet Program).</li>
<li><strong>Seeds</strong>: These are like ingredients in a recipe. They are a series of bytes (often strings, public keys, or numbers) that are combined with the Program ID. The combination of the Program ID and these seeds <em>deterministically</em> generates the PDA. If you use the same Program ID and the same seeds, you will <em>always</em> get the same PDA.</li>
<li><strong>Bump</strong>: Sometimes, a particular combination of seeds might accidentally result in a valid <code>PublicKey</code> that <em>does</em> have a corresponding <code>PrivateKey</code> (this is extremely rare but possible, known as a <code>P-256</code> curve point). To avoid this, Solana adds an extra byte called a &quot;bump seed&quot; or &quot;bump&quot; to the combination. The system automatically finds a <code>bump</code> value that ensures the resulting address <em>cannot</em> be signed by a private key. This is why when you derive a PDA, you often get back both the <code>PublicKey</code> and its <code>bump</code> value.</li>
</ul>
<p>The function used to find a PDA is <code>PublicKey.findProgramAddress([seeds], programId)</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-only-the-program-can-sign">3. Only the Program Can Sign<a href="#3-only-the-program-can-sign" class="hash-link" aria-label="Direct link to 3. Only the Program Can Sign" title="Direct link to 3. Only the Program Can Sign">​</a></h3>
<p>This is the most crucial part: <strong>only the program that deterministically generated a PDA can &quot;sign&quot; for it</strong>. When a program wants to act on behalf of a PDA (e.g., transfer SOL from it), it uses a special instruction called <code>invoke_signed</code>. This instruction proves to the Solana runtime that the calling program is indeed the &quot;owner&quot; of the PDA, allowing it to authorize actions for that PDA.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-goki-uses-pdas">How Goki Uses PDAs<a href="#how-goki-uses-pdas" class="hash-link" aria-label="Direct link to How Goki Uses PDAs" title="Direct link to How Goki Uses PDAs">​</a></h2>
<p>Let&#x27;s look at how Goki leverages PDAs for its core functionality:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-the-smartwallet-account-itself">1. The <code>SmartWallet</code> Account Itself<a href="#1-the-smartwallet-account-itself" class="hash-link" aria-label="Direct link to 1-the-smartwallet-account-itself" title="Direct link to 1-the-smartwallet-account-itself">​</a></h3>
<p>Your main Goki Smart Wallet account is a PDA. This is fundamental because it means the <a href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a> can truly own and control it.</p>
<ul>
<li><strong>Seeds</strong>: <code>[&quot;GokiSmartWallet&quot;, base_public_key]</code>
<ul>
<li><code>&quot;GokiSmartWallet&quot;</code>: A fixed string, a unique identifier for the Smart Wallet type.</li>
<li><code>base_public_key</code>: A public key generated by your regular user wallet. This acts as a unique base for your Smart Wallet.</li>
</ul>
</li>
<li><strong>Why a PDA?</strong>: By making the <code>SmartWallet</code> account a PDA, the <a href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a> can, for instance, transfer SOL directly from this account (once multi-signature conditions are met) using <code>invoke_signed</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-transaction-accounts">2. <code>Transaction</code> Accounts<a href="#2-transaction-accounts" class="hash-link" aria-label="Direct link to 2-transaction-accounts" title="Direct link to 2-transaction-accounts">​</a></h3>
<p>Every time you propose a new transaction using <code>smartWalletWrapper.newTransaction</code>, a new <a href="/doc_goki/docs/transaction-state-account">Transaction State Account</a> is created on the blockchain. This account is also a PDA.</p>
<ul>
<li><strong>Seeds</strong>: <code>[&quot;GokiTransaction&quot;, smart_wallet_public_key, transaction_index]</code>
<ul>
<li><code>&quot;GokiTransaction&quot;</code>: Another fixed string.</li>
<li><code>smart_wallet_public_key</code>: The address of your main <code>SmartWallet</code> PDA.</li>
<li><code>transaction_index</code>: A unique number for each transaction created by that <code>SmartWallet</code>.</li>
</ul>
</li>
<li><strong>Why a PDA?</strong>: This ensures each transaction proposal has a unique, program-controlled address where its state (instructions, approvals, <a href="/doc_goki/docs/timelock">Timelock</a>) can be stored and updated exclusively by the <a href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-derived-wallets">3. Derived Wallets<a href="#3-derived-wallets" class="hash-link" aria-label="Direct link to 3. Derived Wallets" title="Direct link to 3. Derived Wallets">​</a></h3>
<p>Goki also allows you to create &quot;derived wallets.&quot; These are sub-accounts of your main <code>SmartWallet</code> that can hold tokens or SOL separately. They are also PDAs.</p>
<ul>
<li><strong>Seeds</strong>: <code>[&quot;GokiSmartWalletDerived&quot;, smart_wallet_public_key, wallet_index]</code>
<ul>
<li><code>&quot;GokiSmartWalletDerived&quot;</code>: A fixed string.</li>
<li><code>smart_wallet_public_key</code>: The address of your main <code>SmartWallet</code> PDA.</li>
<li><code>wallet_index</code>: A unique number for each derived wallet you create.</li>
</ul>
</li>
<li><strong>Why a PDA?</strong>: This allows the main <code>SmartWallet</code> (via the <a href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a>) to sign for actions related to these derived wallets. For example, a derived wallet could hold a specific token type, and the <code>SmartWallet</code> could approve transactions to send those tokens without directly interacting with the main Smart Wallet&#x27;s SOL balance.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-owner-invokers">4. Owner Invokers<a href="#4-owner-invokers" class="hash-link" aria-label="Direct link to 4. Owner Invokers" title="Direct link to 4. Owner Invokers">​</a></h3>
<p>Owner Invokers are another type of PDA, enabling advanced permissions and interactions.</p>
<ul>
<li><strong>Seeds</strong>: <code>[&quot;GokiSmartWalletOwnerInvoker&quot;, smart_wallet_public_key, invoker_index]</code>
<ul>
<li><code>&quot;GokiSmartWalletOwnerInvoker&quot;</code>: A fixed string.</li>
<li><code>smart_wallet_public_key</code>: The address of your main <code>SmartWallet</code> PDA.</li>
<li><code>invoker_index</code>: A unique number for each owner invoker.</li>
</ul>
</li>
<li><strong>Why a PDA?</strong>: These allow specific <code>owners</code> (or the <code>SmartWallet</code> itself) to delegate very specific, pre-defined actions via CPI, without needing a full multi-signature process for every minor action. It&#x27;s for more advanced, fine-tuned control scenarios.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-finding-pda-addresses">Example: Finding PDA Addresses<a href="#example-finding-pda-addresses" class="hash-link" aria-label="Direct link to Example: Finding PDA Addresses" title="Direct link to Example: Finding PDA Addresses">​</a></h2>
<p>You won&#x27;t typically &quot;create&quot; PDAs directly as a user; the <a href="/doc_goki/docs/goki-sdk">Goki SDK</a> and <a href="/doc_goki/docs/smart-wallet-program">Smart Wallet Program</a> handle that. However, you can always <em>find</em> the address of a PDA given its seeds.</p>
<p>Let&#x27;s see how the <code>SmartWalletWrapper</code> helps you find the addresses of the main Smart Wallet and its derived addresses:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Keypair</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PublicKey </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@solana/web3.js&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> makeSDK </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./workspace&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">BN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bn.js&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sdk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">makeSDK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ownerA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Keypair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">generate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> owners </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ownerA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> threshold </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">BN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> delaySeconds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">BN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Use a known base for a reproducible Smart Wallet PDA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> baseKeypair </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Keypair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">generate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create the Smart Wallet. Its address is a PDA!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newSmartWallet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  numOwners</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> owners</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  owners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  threshold</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  delay</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> delaySeconds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  base</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> baseKeypair</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// We provide the base keypair here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">confirm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Main Smart Wallet PDA Address:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toBase58</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Example Output: Main Smart Wallet PDA Address: B5fD4f...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Find a Wallet Derived Address for an index (e.g., 0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">derivedWallet0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> derivedBump0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findWalletDerivedAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Derived Wallet (Index 0) PDA Address:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> derivedWallet0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toBase58</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Example Output: Derived Wallet (Index 0) PDA Address: 2N3xYt...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Find a Transaction PDA address for a specific index (e.g., 0, first transaction)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">txPDA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> txBump</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> smartWalletWrapper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findTransactionAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;First Transaction PDA Address:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> txPDA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toBase58</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Example Output: First Transaction PDA Address: 6PcV3u...</span><br></span></code></pre></div></div>
<p><em>Explanation</em>:</p>
<ol>
<li>We first create a new <code>SmartWallet</code>. The <code>smartWalletWrapper.key</code> property <em>is</em> the PDA for your Smart Wallet. It was derived using the <code>baseKeypair</code> you provided and the <code>GokiSmartWallet</code> string.</li>
<li>Then, we use <code>smartWalletWrapper.findWalletDerivedAddress(0)</code> to calculate the PDA for a &quot;derived wallet&quot; at index 0. This PDA uses the <code>smartWalletWrapper.key</code> (the main Smart Wallet&#x27;s PDA) and the index <code>0</code> as seeds.</li>
<li>Similarly, <code>smartWalletWrapper.findTransactionAddress(0)</code> calculates the PDA for the <em>first</em> transaction (<code>index: 0</code>) associated with this Smart Wallet.</li>
</ol>
<p>These functions within the <code>SmartWalletWrapper</code> (which rely on utilities in <code>src/wrappers/smartWallet/pda.ts</code>) simply re-run the <code>findProgramAddress</code> calculation to show you what the PDA address <em>would be</em> for a given set of seeds, even before the account is actually created on-chain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p><strong>Program Derived Addresses (PDAs)</strong> are special public keys on Solana that do not have private keys and can only be signed for by the program that generated them. They are deterministically created from a program&#x27;s ID and a set of &quot;seeds.&quot; In Goki, PDAs are fundamental to its architecture, used for the <code>SmartWallet</code> account itself, unique <code>Transaction</code> accounts, and special &quot;derived wallets&quot; or &quot;owner invokers.&quot; This allows the Goki Smart Wallet Program to securely own assets and manage complex multi-signature operations directly on the blockchain, providing a level of security and flexibility not possible with traditional private key-controlled accounts.</p>
<p>This concludes our deep dive into the core concepts of Goki. You now have a comprehensive understanding of how Goki Smart Wallets operate, from the high-level SDK interface to the intricate on-chain program logic, secured by multi-signature approvals, timelocks, CPI, and the power of PDAs.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/stayrar3/doc_goki/tree/main/docs/program-derived-addresses-pdas.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc_goki/docs/instruction-execution-cpi"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Instruction Execution (CPI)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-company-vault-analogy" class="table-of-contents__link toc-highlight">The Company Vault Analogy</a></li><li><a href="#key-concepts-the-magic-of-pdas" class="table-of-contents__link toc-highlight">Key Concepts: The Magic of PDAs</a><ul><li><a href="#1-public-keys-vs-pdas-the-no-private-key-difference" class="table-of-contents__link toc-highlight">1. Public Keys vs. PDAs: The &quot;No Private Key&quot; Difference</a></li><li><a href="#2-deterministic-generation-seeds-and-bumps" class="table-of-contents__link toc-highlight">2. Deterministic Generation: Seeds and Bumps</a></li><li><a href="#3-only-the-program-can-sign" class="table-of-contents__link toc-highlight">3. Only the Program Can Sign</a></li></ul></li><li><a href="#how-goki-uses-pdas" class="table-of-contents__link toc-highlight">How Goki Uses PDAs</a><ul><li><a href="#1-the-smartwallet-account-itself" class="table-of-contents__link toc-highlight">1. The <code>SmartWallet</code> Account Itself</a></li><li><a href="#2-transaction-accounts" class="table-of-contents__link toc-highlight">2. <code>Transaction</code> Accounts</a></li><li><a href="#3-derived-wallets" class="table-of-contents__link toc-highlight">3. Derived Wallets</a></li><li><a href="#4-owner-invokers" class="table-of-contents__link toc-highlight">4. Owner Invokers</a></li></ul></li><li><a href="#example-finding-pda-addresses" class="table-of-contents__link toc-highlight">Example: Finding PDA Addresses</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc_goki/docs/intro">Documentation</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/GokiProtocol/goki" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Goki Documentation. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>